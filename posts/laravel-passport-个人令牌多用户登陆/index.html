<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="color-scheme" content="light dark">

    
      <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests; block-all-mixed-content; default-src 'self'; child-src 'self'; font-src 'self' https://fonts.gstatic.com https://cdn.jsdelivr.net/; form-action 'self'; frame-src 'self'; img-src 'self'; object-src 'none'; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com/ https://cdn.jsdelivr.net/; script-src 'self' 'unsafe-inline' https://www.google-analytics.com https://cdn.jsdelivr.net/; prefetch-src 'self'; connect-src 'self' https://www.google-analytics.com;">

    

    <meta name="author" content="Ethan Kuo">
    <meta name="description" content="å‰è¨€    æœ€è¿‘æœ‰ä¸ªé¡¹ç›®éœ€è¦ç”¨åˆ°å¤šç”¨æˆ·è¡¨ç³»ç»Ÿè®¤è¯ï¼Œå¯¹äº Token çš„å‘æ”¾å’Œé‰´æƒï¼Œä½¿ç”¨äº† Passport æ¥å®ç° API æˆæƒè®¤è¯ï¼Œä½†æ˜¯ Passport å¯¹äºå¤šç”¨æˆ·è¡¨ç™»é™†å®ç°è¿˜æ˜¯æ¯”è¾ƒéš¾çš„ï¼Œåœ¨ç½‘ä¸Šåˆ°çš„ä¸€äº›å¤šç”¨æˆ·è¡¨ç™»é™†ä¹Ÿéƒ½æ˜¯ç”¨ GuzzleHttp æºå¸¦é¢å¤–å‚æ•°æ¥å®ç°çš„ï¼Œä¸å¤ªæ»¡è¶³æˆ‘çš„éœ€æ±‚ã€‚ç»è¿‡äº†ä¸€æ®µæ—¶æœŸçš„æ‘¸ç´¢ï¼Œç»ˆäºå®ç°äº† Passport é€šè¿‡ä¸ªäººä»¤ç‰Œæ¥å¤šç”¨æˆ·ç™»é™†ã€‚
å®ç°    Laravel ç‰ˆæœ¬ 6.0
å®‰è£…    composer require laravel/passport å¯¼å‡ºé»˜è®¤è¿ç§»æ–‡ä»¶    php artisan vendor:publish --tag=passport-migrations è¿è¡Œè¯¥å‘½ä»¤ä¼šåœ¨ \app\database\migrations\ ç”Ÿæˆ
 Date_create_oauth_auth_codes_table.php Date_create_oauth_access_tokens_table.php Date_create_oauth_refresh_tokens_table.php Date_create_oauth_clients_table.php Date_create_oauth_personal_access_clients_table.php  äº”ä¸ªæ•°æ®åº“è¿ç§»æ–‡ä»¶ï¼Œå…¶ä¸­ Date_create_oauth_access_tokens_table æ˜¯ç”¨æ¥è®°å½•å‘æ”¾æˆåŠŸçš„ Token çš„ã€‚æˆ‘ä»¬éœ€è¦æ‹·è´ä¸€ä¸ªè¿™ä¸ªè¡¨ç”¨æ¥å»ºç«‹å¦ä¸€ä¸ªç”¨æˆ·è¡¨çš„ Token è®°å½•ã€‚
å»ºç«‹è‡ªå®šä¹‰ access_token è¡¨    php artisan make:migration create_oauth_other_tokens --create=oauth_other_tokens ç”Ÿæˆ Date_create_oauth_other_tokens è¿ç§»æ–‡ä»¶ã€‚">
    <meta name="keywords" content="Passport,Laravel,Oauth">

    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Laravel Passport ä¸ªäººä»¤ç‰Œå¤šç”¨æˆ·ç™»é™†"/>
<meta name="twitter:description" content="å‰è¨€    æœ€è¿‘æœ‰ä¸ªé¡¹ç›®éœ€è¦ç”¨åˆ°å¤šç”¨æˆ·è¡¨ç³»ç»Ÿè®¤è¯ï¼Œå¯¹äº Token çš„å‘æ”¾å’Œé‰´æƒï¼Œä½¿ç”¨äº† Passport æ¥å®ç° API æˆæƒè®¤è¯ï¼Œä½†æ˜¯ Passport å¯¹äºå¤šç”¨æˆ·è¡¨ç™»é™†å®ç°è¿˜æ˜¯æ¯”è¾ƒéš¾çš„ï¼Œåœ¨ç½‘ä¸Šåˆ°çš„ä¸€äº›å¤šç”¨æˆ·è¡¨ç™»é™†ä¹Ÿéƒ½æ˜¯ç”¨ GuzzleHttp æºå¸¦é¢å¤–å‚æ•°æ¥å®ç°çš„ï¼Œä¸å¤ªæ»¡è¶³æˆ‘çš„éœ€æ±‚ã€‚ç»è¿‡äº†ä¸€æ®µæ—¶æœŸçš„æ‘¸ç´¢ï¼Œç»ˆäºå®ç°äº† Passport é€šè¿‡ä¸ªäººä»¤ç‰Œæ¥å¤šç”¨æˆ·ç™»é™†ã€‚
å®ç°    Laravel ç‰ˆæœ¬ 6.0
å®‰è£…    composer require laravel/passport å¯¼å‡ºé»˜è®¤è¿ç§»æ–‡ä»¶    php artisan vendor:publish --tag=passport-migrations è¿è¡Œè¯¥å‘½ä»¤ä¼šåœ¨ \app\database\migrations\ ç”Ÿæˆ
 Date_create_oauth_auth_codes_table.php Date_create_oauth_access_tokens_table.php Date_create_oauth_refresh_tokens_table.php Date_create_oauth_clients_table.php Date_create_oauth_personal_access_clients_table.php  äº”ä¸ªæ•°æ®åº“è¿ç§»æ–‡ä»¶ï¼Œå…¶ä¸­ Date_create_oauth_access_tokens_table æ˜¯ç”¨æ¥è®°å½•å‘æ”¾æˆåŠŸçš„ Token çš„ã€‚æˆ‘ä»¬éœ€è¦æ‹·è´ä¸€ä¸ªè¿™ä¸ªè¡¨ç”¨æ¥å»ºç«‹å¦ä¸€ä¸ªç”¨æˆ·è¡¨çš„ Token è®°å½•ã€‚
å»ºç«‹è‡ªå®šä¹‰ access_token è¡¨    php artisan make:migration create_oauth_other_tokens --create=oauth_other_tokens ç”Ÿæˆ Date_create_oauth_other_tokens è¿ç§»æ–‡ä»¶ã€‚"/>

    <meta property="og:title" content="Laravel Passport ä¸ªäººä»¤ç‰Œå¤šç”¨æˆ·ç™»é™†" />
<meta property="og:description" content="å‰è¨€    æœ€è¿‘æœ‰ä¸ªé¡¹ç›®éœ€è¦ç”¨åˆ°å¤šç”¨æˆ·è¡¨ç³»ç»Ÿè®¤è¯ï¼Œå¯¹äº Token çš„å‘æ”¾å’Œé‰´æƒï¼Œä½¿ç”¨äº† Passport æ¥å®ç° API æˆæƒè®¤è¯ï¼Œä½†æ˜¯ Passport å¯¹äºå¤šç”¨æˆ·è¡¨ç™»é™†å®ç°è¿˜æ˜¯æ¯”è¾ƒéš¾çš„ï¼Œåœ¨ç½‘ä¸Šåˆ°çš„ä¸€äº›å¤šç”¨æˆ·è¡¨ç™»é™†ä¹Ÿéƒ½æ˜¯ç”¨ GuzzleHttp æºå¸¦é¢å¤–å‚æ•°æ¥å®ç°çš„ï¼Œä¸å¤ªæ»¡è¶³æˆ‘çš„éœ€æ±‚ã€‚ç»è¿‡äº†ä¸€æ®µæ—¶æœŸçš„æ‘¸ç´¢ï¼Œç»ˆäºå®ç°äº† Passport é€šè¿‡ä¸ªäººä»¤ç‰Œæ¥å¤šç”¨æˆ·ç™»é™†ã€‚
å®ç°    Laravel ç‰ˆæœ¬ 6.0
å®‰è£…    composer require laravel/passport å¯¼å‡ºé»˜è®¤è¿ç§»æ–‡ä»¶    php artisan vendor:publish --tag=passport-migrations è¿è¡Œè¯¥å‘½ä»¤ä¼šåœ¨ \app\database\migrations\ ç”Ÿæˆ
 Date_create_oauth_auth_codes_table.php Date_create_oauth_access_tokens_table.php Date_create_oauth_refresh_tokens_table.php Date_create_oauth_clients_table.php Date_create_oauth_personal_access_clients_table.php  äº”ä¸ªæ•°æ®åº“è¿ç§»æ–‡ä»¶ï¼Œå…¶ä¸­ Date_create_oauth_access_tokens_table æ˜¯ç”¨æ¥è®°å½•å‘æ”¾æˆåŠŸçš„ Token çš„ã€‚æˆ‘ä»¬éœ€è¦æ‹·è´ä¸€ä¸ªè¿™ä¸ªè¡¨ç”¨æ¥å»ºç«‹å¦ä¸€ä¸ªç”¨æˆ·è¡¨çš„ Token è®°å½•ã€‚
å»ºç«‹è‡ªå®šä¹‰ access_token è¡¨    php artisan make:migration create_oauth_other_tokens --create=oauth_other_tokens ç”Ÿæˆ Date_create_oauth_other_tokens è¿ç§»æ–‡ä»¶ã€‚" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://blog.adminchao.com/posts/laravel-passport-%E4%B8%AA%E4%BA%BA%E4%BB%A4%E7%89%8C%E5%A4%9A%E7%94%A8%E6%88%B7%E7%99%BB%E9%99%86/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-03-27T21:08:27+00:00" />
<meta property="article:modified_time" content="2020-03-27T21:08:27+00:00" />



    <title>
  Laravel Passport ä¸ªäººä»¤ç‰Œå¤šç”¨æˆ·ç™»é™† Â· Ethan Kuo Blog
</title>

    
      <link rel="canonical" href="https://blog.adminchao.com/posts/laravel-passport-%E4%B8%AA%E4%BA%BA%E4%BB%A4%E7%89%8C%E5%A4%9A%E7%94%A8%E6%88%B7%E7%99%BB%E9%99%86/">
    

    <link rel="preload" href="/fonts/forkawesome-webfont.woff2?v=1.2.0" as="font" type="font/woff2" crossorigin>

    
      
      
      <link rel="stylesheet" href="/css/coder.min.d9fddbffe6f27e69985dc5fe0471cdb0e57fbf4775714bc3d847accb08f4a1f6.css" integrity="sha256-2f3b/&#43;byfmmYXcX&#43;BHHNsOV/v0d1cUvD2Eesywj0ofY=" crossorigin="anonymous" media="screen" />
    

    

    
      
        
        
        <link rel="stylesheet" href="/css/coder-dark.min.002ee2378e14c7a68f1f0a53d9694ed252090987c4e768023fac694a4fc5f793.css" integrity="sha256-AC7iN44Ux6aPHwpT2WlO0lIJCYfE52gCP6xpSk/F95M=" crossorigin="anonymous" media="screen" />
      
    

    

    

    <link rel="icon" type="image/png" href="/images/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/images/favicon-16x16.png" sizes="16x16">

    <link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

    <meta name="generator" content="Hugo 0.89.1" />
  </head>

  
  
    
  
  <body class="preload-transitions colorscheme-auto">
    
<div class="float-container">
    <a id="dark-mode-toggle" class="colorscheme-toggle">
        <i class="fa fa-adjust fa-fw" aria-hidden="true"></i>
    </a>
</div>


    <main class="wrapper">
      <nav class="navigation">
  <section class="container">
    <a class="navigation-title" href="/">
      Ethan Kuo Blog
    </a>
    
      <input type="checkbox" id="menu-toggle" />
      <label class="menu-button float-right" for="menu-toggle">
        <i class="fa fa-bars fa-fw" aria-hidden="true"></i>
      </label>
      <ul class="navigation-list">
        
          
            <li class="navigation-item">
              <a class="navigation-link" href="/about/">About</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link" href="/posts/">Blog</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link" href="/projects/">Projects</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link" href="/contact/">Contact me</a>
            </li>
          
        
        
          
          
          
            
          
            
              
                <li class="navigation-item menu-separator">
                  <span>|</span>
                </li>
                
              
              <li class="navigation-item">
                <a href="https://blog.adminchao.com/zh-cn/">ğŸ‡ºğŸ‡¸</a>
              </li>
            
          
        
      </ul>
    
  </section>
</nav>


      <div class="content">
        
  <section class="container post">
    <article>
      <header>
        <div class="post-title">
          <h1 class="title">
            <a class="title-link" href="https://blog.adminchao.com/posts/laravel-passport-%E4%B8%AA%E4%BA%BA%E4%BB%A4%E7%89%8C%E5%A4%9A%E7%94%A8%E6%88%B7%E7%99%BB%E9%99%86/">
              Laravel Passport ä¸ªäººä»¤ç‰Œå¤šç”¨æˆ·ç™»é™†
            </a>
          </h1>
        </div>
        <div class="post-meta">
          <div class="date">
            <span class="posted-on">
              <i class="fa fa-calendar" aria-hidden="true"></i>
              <time datetime="2020-03-27T21:08:27Z">
                2020-03-27 21:08:27
              </time>
            </span>
            <span class="reading-time">
              <i class="fa fa-clock-o" aria-hidden="true"></i>
              5-minute read
            </span>
          </div>
          
          <div class="categories">
  <i class="fa fa-folder" aria-hidden="true"></i>
    <a href="/categories/laravel/">Laravel</a></div>

          <div class="tags">
  <i class="fa fa-tag" aria-hidden="true"></i>
    <span class="tag">
      <a href="/tags/laravel/">Laravel</a>
    </span>
      <span class="separator">â€¢</span>
    <span class="tag">
      <a href="/tags/passport/">Passport</a>
    </span>
      <span class="separator">â€¢</span>
    <span class="tag">
      <a href="/tags/oauth/">Oauth</a>
    </span>
      <span class="separator">â€¢</span>
    <span class="tag">
      <a href="/tags/php/">php</a>
    </span></div>

        </div>
      </header>

      <div>
        
        <h2 id="å‰è¨€">
  å‰è¨€
  <a class="heading-link" href="#%e5%89%8d%e8%a8%80">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h2>
<p>æœ€è¿‘æœ‰ä¸ªé¡¹ç›®éœ€è¦ç”¨åˆ°å¤šç”¨æˆ·è¡¨ç³»ç»Ÿè®¤è¯ï¼Œå¯¹äº Token çš„å‘æ”¾å’Œé‰´æƒï¼Œä½¿ç”¨äº† Passport æ¥å®ç° API æˆæƒè®¤è¯ï¼Œä½†æ˜¯ Passport å¯¹äºå¤šç”¨æˆ·è¡¨ç™»é™†å®ç°è¿˜æ˜¯æ¯”è¾ƒéš¾çš„ï¼Œåœ¨ç½‘ä¸Šåˆ°çš„ä¸€äº›å¤šç”¨æˆ·è¡¨ç™»é™†ä¹Ÿéƒ½æ˜¯ç”¨ GuzzleHttp æºå¸¦é¢å¤–å‚æ•°æ¥å®ç°çš„ï¼Œä¸å¤ªæ»¡è¶³æˆ‘çš„éœ€æ±‚ã€‚ç»è¿‡äº†ä¸€æ®µæ—¶æœŸçš„æ‘¸ç´¢ï¼Œç»ˆäºå®ç°äº† Passport é€šè¿‡ä¸ªäººä»¤ç‰Œæ¥å¤šç”¨æˆ·ç™»é™†ã€‚</p>
<h2 id="å®ç°">
  å®ç°
  <a class="heading-link" href="#%e5%ae%9e%e7%8e%b0">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h2>
<p>Laravel ç‰ˆæœ¬ 6.0</p>
<h3 id="å®‰è£…">
  å®‰è£…
  <a class="heading-link" href="#%e5%ae%89%e8%a3%85">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php">composer <span style="font-weight:bold">require</span> laravel/passport
</code></pre></div><h3 id="å¯¼å‡ºé»˜è®¤è¿ç§»æ–‡ä»¶">
  å¯¼å‡ºé»˜è®¤è¿ç§»æ–‡ä»¶
  <a class="heading-link" href="#%e5%af%bc%e5%87%ba%e9%bb%98%e8%ae%a4%e8%bf%81%e7%a7%bb%e6%96%87%e4%bb%b6">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php">php artisan vendor:publish --tag=passport-migrations
</code></pre></div><p>è¿è¡Œè¯¥å‘½ä»¤ä¼šåœ¨ <code>\app\database\migrations\</code> ç”Ÿæˆ</p>
<ul>
<li>Date_create_oauth_auth_codes_table.php</li>
<li>Date_create_oauth_access_tokens_table.php</li>
<li>Date_create_oauth_refresh_tokens_table.php</li>
<li>Date_create_oauth_clients_table.php</li>
<li>Date_create_oauth_personal_access_clients_table.php</li>
</ul>
<p>äº”ä¸ªæ•°æ®åº“è¿ç§»æ–‡ä»¶ï¼Œå…¶ä¸­ <code>Date_create_oauth_access_tokens_table</code> æ˜¯ç”¨æ¥è®°å½•å‘æ”¾æˆåŠŸçš„ Token çš„ã€‚æˆ‘ä»¬éœ€è¦æ‹·è´ä¸€ä¸ªè¿™ä¸ªè¡¨ç”¨æ¥å»ºç«‹å¦ä¸€ä¸ªç”¨æˆ·è¡¨çš„ Token è®°å½•ã€‚</p>
<h3 id="å»ºç«‹è‡ªå®šä¹‰-access_token-è¡¨">
  å»ºç«‹è‡ªå®šä¹‰ access_token è¡¨
  <a class="heading-link" href="#%e5%bb%ba%e7%ab%8b%e8%87%aa%e5%ae%9a%e4%b9%89-access_token-%e8%a1%a8">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">php artisan make:migration create_oauth_other_tokens --create=oauth_other_tokens
</code></pre></div><p>ç”Ÿæˆ <code>Date_create_oauth_other_tokens</code> è¿ç§»æ–‡ä»¶ã€‚</p>
<p>å¤åˆ¶ <code>Date_create_oauth_access_tokens_table</code> æ–‡ä»¶å†…å®¹åˆ° <code>Date_create_oauth_other_tokens</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php">&lt;?php

<span style="font-weight:bold">use</span> Illuminate\Database\Migrations\Migration;
<span style="font-weight:bold">use</span> Illuminate\Database\Schema\Blueprint;
<span style="font-weight:bold">use</span> Illuminate\Support\Facades\Schema;

<span style="font-weight:bold">class</span> <span style="font-weight:bold">CreateOauthOtherTokens</span> <span style="font-weight:bold">extends</span> Migration
{
    <span style="font-style:italic">/**
</span><span style="font-style:italic">     * Run the migrations.
</span><span style="font-style:italic">     *
</span><span style="font-style:italic">     * @return void
</span><span style="font-style:italic">     */</span>
    <span style="font-weight:bold">public</span> <span style="font-weight:bold">function</span> up()
    {
        Schema::create(<span style="font-style:italic">&#39;oauth_other_tokens&#39;</span>, <span style="font-weight:bold">function</span> (Blueprint $table) {
            $table-&gt;string(<span style="font-style:italic">&#39;id&#39;</span>, 100)-&gt;primary();
            $table-&gt;unsignedBigInteger(<span style="font-style:italic">&#39;user_id&#39;</span>)-&gt;nullable()-&gt;index();
            $table-&gt;unsignedBigInteger(<span style="font-style:italic">&#39;client_id&#39;</span>);
            $table-&gt;string(<span style="font-style:italic">&#39;name&#39;</span>)-&gt;nullable();
            $table-&gt;text(<span style="font-style:italic">&#39;scopes&#39;</span>)-&gt;nullable();
            $table-&gt;boolean(<span style="font-style:italic">&#39;revoked&#39;</span>);
            $table-&gt;timestamps();
            $table-&gt;dateTime(<span style="font-style:italic">&#39;expires_at&#39;</span>)-&gt;nullable();
        });
    }

    <span style="font-style:italic">/**
</span><span style="font-style:italic">     * Reverse the migrations.
</span><span style="font-style:italic">     *
</span><span style="font-style:italic">     * @return void
</span><span style="font-style:italic">     */</span>
    <span style="font-weight:bold">public</span> <span style="font-weight:bold">function</span> down()
    {
        Schema::dropIfExists(<span style="font-style:italic">&#39;oauth_other_tokens&#39;</span>);
    }
}

</code></pre></div><h3 id="è¿è¡Œæ•°æ®åº“è¿ç§»">
  è¿è¡Œæ•°æ®åº“è¿ç§»
  <a class="heading-link" href="#%e8%bf%90%e8%a1%8c%e6%95%b0%e6%8d%ae%e5%ba%93%e8%bf%81%e7%a7%bb">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php">php artisan migrate
</code></pre></div><h3 id="ç”Ÿæˆå®¢æˆ·ç«¯">
  ç”Ÿæˆå®¢æˆ·ç«¯
  <a class="heading-link" href="#%e7%94%9f%e6%88%90%e5%ae%a2%e6%88%b7%e7%ab%af">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h3>
<p>ç”Ÿæˆä¸¤ä¸ª <code>personal</code> å®¢æˆ·ç«¯ï¼Œä¸€ä¸ªç”¨ä¸ User ç”¨æˆ·ï¼Œä¸€ä¸ªç”¨äº Other ç”¨æˆ·</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="font-style:italic">#1</span>
php artisan passport:client --personal

What should we name the personal access client? []:
 &gt; User

Personal access client created successfully.
Client ID: 1
Client secret: 7KqVA8gPxRhPtFdfdsfsuVi4n3xpUBOEiNW4lPI

<span style="font-style:italic">#2</span>
php artisan passport:client --personal

What should we name the personal access client? []:
 &gt; Other

Personal access client created successfully.
Client ID: 2
Client secret: 7KqVA8gPxRhPtFdfdsfsuVi4n3xpUBOEiNW4fde

</code></pre></div><h3 id="åˆ›å»ºè‡ªå®šä¹‰-access_tokens-æ¨¡å‹">
  åˆ›å»ºè‡ªå®šä¹‰ access_tokens æ¨¡å‹
  <a class="heading-link" href="#%e5%88%9b%e5%bb%ba%e8%87%aa%e5%ae%9a%e4%b9%89-access_tokens-%e6%a8%a1%e5%9e%8b">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php">php artisan make:model OtherToken
</code></pre></div><p><code>\app\OtherToken.php</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php">&lt;?php

<span style="font-weight:bold">namespace</span> App;

<span style="font-weight:bold">use</span> Illuminate\Database\Eloquent\Model;
<span style="font-weight:bold">use</span> Laravel\Passport\Token;

<span style="font-style:italic">//è¿™é‡Œè¦æ³¨æ„ç»§æ‰¿ Laravel\Passport\Token
</span><span style="font-style:italic"></span><span style="font-weight:bold">class</span> <span style="font-weight:bold">MiniToken</span> <span style="font-weight:bold">extends</span> Token
{
    <span style="font-weight:bold">protected</span> $table = <span style="font-style:italic">&#39;oauth_other_tokens&#39;</span>;


    <span style="font-weight:bold">public</span> <span style="font-weight:bold">function</span> user()
    {
        $provider = config(<span style="font-style:italic">&#39;auth.guards.other.provider&#39;</span>);

        <span style="font-weight:bold">return</span> $this-&gt;belongsTo(config(<span style="font-style:italic">&#39;auth.providers.&#39;</span>.$provider.<span style="font-style:italic">&#39;.model&#39;</span>));
    }
}

</code></pre></div><h3 id="é…ç½®">
  é…ç½®
  <a class="heading-link" href="#%e9%85%8d%e7%bd%ae">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h3>
<p><code>\config\auth.php</code> é…ç½®å¦ä¸€ä¸ªç”¨æˆ·æ¨¡å‹</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php">   <span style="font-style:italic">&#39;guards&#39;</span> =&gt; [
        <span style="font-style:italic">&#39;web&#39;</span> =&gt; [
            <span style="font-style:italic">&#39;driver&#39;</span> =&gt; <span style="font-style:italic">&#39;session&#39;</span>,
            <span style="font-style:italic">&#39;provider&#39;</span> =&gt; <span style="font-style:italic">&#39;users&#39;</span>,
        ],

        <span style="font-style:italic">&#39;api&#39;</span> =&gt; [
            <span style="font-style:italic">&#39;driver&#39;</span> =&gt; <span style="font-style:italic">&#39;passport&#39;</span>,
            <span style="font-style:italic">&#39;provider&#39;</span> =&gt; <span style="font-style:italic">&#39;users&#39;</span>,
<span style="font-style:italic">//            &#39;hash&#39; =&gt; false,
</span><span style="font-style:italic"></span>        ],
        <span style="font-style:italic">&#39;other&#39;</span> =&gt; [
            <span style="font-style:italic">&#39;driver&#39;</span> =&gt; <span style="font-style:italic">&#39;passport&#39;</span>,
            <span style="font-style:italic">&#39;provider&#39;</span> =&gt; <span style="font-style:italic">&#39;others&#39;</span>,
        ],
    ],

<span style="font-style:italic">&#39;providers&#39;</span> =&gt; [
        <span style="font-style:italic">&#39;users&#39;</span> =&gt; [
            <span style="font-style:italic">&#39;driver&#39;</span> =&gt; <span style="font-style:italic">&#39;eloquent&#39;</span>,
            <span style="font-style:italic">&#39;model&#39;</span> =&gt; App\User::class,
        ],
        <span style="font-style:italic">&#39;others&#39;</span> =&gt; [
            <span style="font-style:italic">&#39;driver&#39;</span> =&gt; <span style="font-style:italic">&#39;eloquent&#39;</span>,
            <span style="font-style:italic">&#39;model&#39;</span> =&gt; App\Other::class,
        ],

        <span style="font-style:italic">// &#39;users&#39; =&gt; [
</span><span style="font-style:italic"></span>        <span style="font-style:italic">//     &#39;driver&#39; =&gt; &#39;database&#39;,
</span><span style="font-style:italic"></span>        <span style="font-style:italic">//     &#39;table&#39; =&gt; &#39;users&#39;,
</span><span style="font-style:italic"></span>        <span style="font-style:italic">// ],
</span><span style="font-style:italic"></span>    ],
</code></pre></div><h3 id="åˆ›å»ºä¸­é—´ä»¶">
  åˆ›å»ºä¸­é—´ä»¶
  <a class="heading-link" href="#%e5%88%9b%e5%bb%ba%e4%b8%ad%e9%97%b4%e4%bb%b6">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h3>
<p>å¯¹ä¸¤ä¸ªç”¨æˆ·è·¯ç”±åˆ†åˆ«åˆ›å»ºä¸­é—´ä»¶ï¼Œæ­¤ä¸­é—´ä»¶ä¸»è¦ç”¨æ¥è®¾ç½® Passport ç›¸å¯¹åº”çš„ Token æ¨¡å‹</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php">php artisan make:middleware UserPassport
php artisan make:middleware OtherPassport
</code></pre></div><p>åœ¨ä¸­é—´ä»¶è®¾ç½®å“åº” Token æ¨¡å‹</p>
<p><code>\app\Http\Middleware\UserPassport.php</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php">&lt;?php

<span style="font-weight:bold">namespace</span> App\Http\Middleware;

<span style="font-weight:bold">use</span> Closure;
<span style="font-weight:bold">use</span> Laravel\Passport\Passport;

<span style="font-weight:bold">class</span> <span style="font-weight:bold">UserPassport</span>
{
    <span style="font-style:italic">/**
</span><span style="font-style:italic">     * Handle an incoming request.
</span><span style="font-style:italic">     *
</span><span style="font-style:italic">     * @param  \Illuminate\Http\Request  $request
</span><span style="font-style:italic">     * @param  \Closure  $next
</span><span style="font-style:italic">     * @return mixed
</span><span style="font-style:italic">     */</span>
    <span style="font-weight:bold">public</span> <span style="font-weight:bold">function</span> handle($request, Closure $next)
    {
      	<span style="font-style:italic">//è¿™é‡Œç”¨åŸæ¥çš„ Token æ¨¡å‹
</span><span style="font-style:italic"></span>        Passport::useTokenModel(<span style="font-style:italic">&#39;Laravel\Passport\Token&#39;</span>);
      	<span style="font-style:italic">//è®¾ç½® ClientId
</span><span style="font-style:italic"></span>        Passport::personalAccessClientId(config(<span style="font-style:italic">&#39;auth.clients.api&#39;</span>));
        <span style="font-weight:bold">return</span> $next($request);
    }
}

</code></pre></div><p><code>\app\Http\Middleware\OtherPassport</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php">&lt;?php

<span style="font-weight:bold">namespace</span> App\Http\Middleware;

<span style="font-weight:bold">use</span> Closure;
<span style="font-weight:bold">use</span> Laravel\Passport\Passport;

<span style="font-weight:bold">class</span> <span style="font-weight:bold">MiniPassport</span>
{
    <span style="font-style:italic">/**
</span><span style="font-style:italic">     * Handle an incoming request.
</span><span style="font-style:italic">     *
</span><span style="font-style:italic">     * @param  \Illuminate\Http\Request  $request
</span><span style="font-style:italic">     * @param  \Closure  $next
</span><span style="font-style:italic">     * @return mixed
</span><span style="font-style:italic">     */</span>
    <span style="font-weight:bold">public</span> <span style="font-weight:bold">function</span> handle($request, Closure $next)
    {
      	<span style="font-style:italic">//ä½¿ç”¨è‡ªå®šä¹‰ Token æ¨¡å‹
</span><span style="font-style:italic"></span>        Passport::useTokenModel(<span style="font-style:italic">&#39;App\MiniToken&#39;</span>);
      	<span style="font-style:italic">//è®¾ç½® ClientId
</span><span style="font-style:italic"></span>        Passport::personalAccessClientId(config(<span style="font-style:italic">&#39;auth.clients.other&#39;</span>));
        <span style="font-weight:bold">return</span> $next($request);
    }
}
</code></pre></div><h3 id="æ³¨å†Œä¸­é—´ä»¶">
  æ³¨å†Œä¸­é—´ä»¶
  <a class="heading-link" href="#%e6%b3%a8%e5%86%8c%e4%b8%ad%e9%97%b4%e4%bb%b6">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h3>
<p><code>app\Http\Kernel.php</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="font-weight:bold">protected</span> $middlewareGroups = [
        <span style="font-style:italic">&#39;web&#39;</span> =&gt; [
            \App\Http\Middleware\EncryptCookies::class,
            \Illuminate\Cookie\Middleware\AddQueuedCookiesToResponse::class,
            \Illuminate\Session\Middleware\StartSession::class,
            <span style="font-style:italic">// \Illuminate\Session\Middleware\AuthenticateSession::class,
</span><span style="font-style:italic"></span>            \Illuminate\View\Middleware\ShareErrorsFromSession::class,
            \App\Http\Middleware\VerifyCsrfToken::class,
            \Illuminate\Routing\Middleware\SubstituteBindings::class,
        ],

        <span style="font-style:italic">&#39;api&#39;</span> =&gt; [
            <span style="font-style:italic">&#39;throttle:60,1&#39;</span>,
            \Illuminate\Routing\Middleware\SubstituteBindings::class,
						\App\Http\Middleware\ApiPassport::class,
        ],

        <span style="font-style:italic">&#39;other&#39;</span> =&gt; [
            <span style="font-style:italic">&#39;throttle:60,1&#39;</span>,
            \Illuminate\Routing\Middleware\SubstituteBindings::class,
            \App\Http\Middleware\MiniPassport::class,
        ],
    ];
</code></pre></div><h3 id="è®¾ç½®-token-è¿‡æœŸæ—¶é—´">
  è®¾ç½® Token è¿‡æœŸæ—¶é—´
  <a class="heading-link" href="#%e8%ae%be%e7%bd%ae-token-%e8%bf%87%e6%9c%9f%e6%97%b6%e9%97%b4">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h3>
<p><code>app\Providers\AuthServiceProvider.php</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php">&lt;?php

<span style="font-weight:bold">namespace</span> App\Providers;

<span style="font-weight:bold">use</span> Carbon\Carbon;
<span style="font-weight:bold">use</span> Illuminate\Foundation\Support\Providers\AuthServiceProvider <span style="font-weight:bold">as</span> ServiceProvider;
<span style="font-weight:bold">use</span> Illuminate\Support\Facades\Gate;
<span style="font-weight:bold">use</span> Laravel\Passport\Client;
<span style="font-weight:bold">use</span> Laravel\Passport\Passport;
<span style="font-weight:bold">use</span> Laravel\Passport\RouteRegistrar;

<span style="font-weight:bold">class</span> <span style="font-weight:bold">AuthServiceProvider</span> <span style="font-weight:bold">extends</span> ServiceProvider
{
    <span style="font-style:italic">/**
</span><span style="font-style:italic">     * The policy mappings for the application.
</span><span style="font-style:italic">     *
</span><span style="font-style:italic">     * @var array
</span><span style="font-style:italic">     */</span>
    <span style="font-weight:bold">protected</span> $policies = [
        <span style="font-style:italic">// &#39;App\Model&#39; =&gt; &#39;App\Policies\ModelPolicy&#39;,
</span><span style="font-style:italic"></span>    ];

    <span style="font-style:italic">/**
</span><span style="font-style:italic">     * Register any authentication / authorization services.
</span><span style="font-style:italic">     *
</span><span style="font-style:italic">     * @return void
</span><span style="font-style:italic">     */</span>
    <span style="font-weight:bold">public</span> <span style="font-weight:bold">function</span> boot()
    {
        $this-&gt;registerPolicies();
        <span style="font-style:italic">//é»˜è®¤ä»¤ç‰Œå‘æ”¾çš„æœ‰æ•ˆæœŸæ˜¯æ°¸ä¹…
</span><span style="font-style:italic"></span>
        Passport::personalAccessTokensExpireIn(Carbon::now()-&gt;addWeeks(2));
    }
}

</code></pre></div><h3 id="æ¨¡å‹-use-trait">
  æ¨¡å‹ Use Trait
  <a class="heading-link" href="#%e6%a8%a1%e5%9e%8b-use-trait">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h3>
<p><code>User</code> æ¨¡å‹ å’Œ <code>Other</code> æ¨¡å‹éƒ½è¦ <code>Use HasApiTokens</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="font-weight:bold">class</span> <span style="font-weight:bold">Other</span> <span style="font-weight:bold">extends</span> Authenticatable
{
    <span style="font-weight:bold">use</span> HasApiTokens,Notifiable;

    <span style="font-weight:bold">protected</span> $table = <span style="font-style:italic">&#39;drivers&#39;</span>;
    <span style="font-weight:bold">protected</span> $appends = [<span style="font-style:italic">&#39;user_name&#39;</span>,<span style="font-style:italic">&#39;company_name&#39;</span>];


    <span style="font-weight:bold">public</span> <span style="font-weight:bold">function</span> getUserNameAttribute(){
        <span style="font-weight:bold">return</span> $this-&gt;hasOne(<span style="font-style:italic">&#39;App\User&#39;</span>,<span style="font-style:italic">&#39;id&#39;</span>,<span style="font-style:italic">&#39;user_id&#39;</span>)-&gt;value(<span style="font-style:italic">&#39;email&#39;</span>);
    }

    <span style="font-weight:bold">public</span> <span style="font-weight:bold">function</span> getCompanyNameAttribute(){
        <span style="font-weight:bold">return</span> $this-&gt;hasOne(<span style="font-style:italic">&#39;App\company&#39;</span>,<span style="font-style:italic">&#39;id&#39;</span>,<span style="font-style:italic">&#39;company_id&#39;</span>)-&gt;value(<span style="font-style:italic">&#39;company_code&#39;</span>);
    }

}

<span style="font-style:italic">// User æ¨¡å‹ç±»ä¼¼
</span></code></pre></div><h3 id="æ ¼å¼åŒ–è¿”å›ä¿¡æ¯">
  æ ¼å¼åŒ–è¿”å›ä¿¡æ¯
  <a class="heading-link" href="#%e6%a0%bc%e5%bc%8f%e5%8c%96%e8%bf%94%e5%9b%9e%e4%bf%a1%e6%81%af">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h3>
<p>éªŒè¯å¤±è´¥è¿”å›æ ¼å¼åŒ– json æ•°æ®</p>
<p>åœ¨ <code>\app\Exceptions\Handler.php</code> ä¸­</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="font-weight:bold">public</span> <span style="font-weight:bold">function</span> render($request, Exception $exception)
    {
  			<span style="font-style:italic">//åˆ¤æ–­è·¯ç”±
</span><span style="font-style:italic"></span>        <span style="font-weight:bold">if</span> ($request-&gt;is(<span style="font-style:italic">&#39;api/*&#39;</span>) || $request-&gt;is(<span style="font-style:italic">&#39;other/*&#39;</span>)){
          	<span style="font-style:italic">//åˆ¤æ–­å¦‚æœæ˜¯æäº¤æ•°æ®éªŒè¯é”™è¯¯
</span><span style="font-style:italic"></span>            <span style="font-weight:bold">if</span> ($exception instanceof ValidationException){
              <span style="font-style:italic">//$this-&gt;error æ˜¯è‡ªå·±å°è£…çš„ä¸€ä¸ª Trait è¿”å› json æ•°æ®ï¼Œæ‚¨ä¹Ÿå¯ä»¥è‡ªå·±å°è£…ï¼Œè¿™é‡Œä¸å†å±•ç¤º
</span><span style="font-style:italic"></span>                <span style="font-weight:bold">return</span> $this-&gt;error(current($exception-&gt;errors())[0],42200,$exception-&gt;status);
            <span style="font-style:italic">//åˆ¤æ–­å¦‚æœæ˜¯é‰´æƒé”™è¯¯
</span><span style="font-style:italic"></span>            }<span style="font-weight:bold">elseif</span>($exception instanceof AuthenticationException){
               <span style="font-style:italic">//$this-&gt;error æ˜¯è‡ªå·±å°è£…çš„ä¸€ä¸ª Trait è¿”å› json æ•°æ®ï¼Œæ‚¨ä¹Ÿå¯ä»¥è‡ªå·±å°è£…ï¼Œè¿™é‡Œä¸å†å±•ç¤º
</span><span style="font-style:italic"></span>                <span style="font-weight:bold">return</span> $this-&gt;error(<span style="font-style:italic">&#39;æˆæƒå¤±è´¥&#39;</span>,40100,401);
            }
        }
        <span style="font-weight:bold">return</span> <span style="font-weight:bold">parent</span>::render($request, $exception);
    }
</code></pre></div><h2 id="ä½¿ç”¨">
  ä½¿ç”¨
  <a class="heading-link" href="#%e4%bd%bf%e7%94%a8">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h2>
<p>è‡ªå®šä¹‰è·¯ç”±æ–‡ä»¶è‡ªå·±è§£å†³å“¦ ^_^</p>
<h3 id="è·¯ç”±">
  è·¯ç”±
  <a class="heading-link" href="#%e8%b7%af%e7%94%b1">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h3>
<p><code>\routes\api.php</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php">&lt;?php

<span style="font-weight:bold">use</span> Illuminate\Http\Request;

<span style="font-style:italic">/*
</span><span style="font-style:italic">|--------------------------------------------------------------------------
</span><span style="font-style:italic">| API Routes
</span><span style="font-style:italic">|--------------------------------------------------------------------------
</span><span style="font-style:italic">|
</span><span style="font-style:italic">| Here is where you can register API routes for your application. These
</span><span style="font-style:italic">| routes are loaded by the RouteServiceProvider within a group which
</span><span style="font-style:italic">| is assigned the &#34;api&#34; middleware group. Enjoy building your API!
</span><span style="font-style:italic">|
</span><span style="font-style:italic">*/</span>
Route::prefix(<span style="font-style:italic">&#39;v1&#39;</span>)-&gt;group(<span style="font-weight:bold">function</span> (){
    <span style="font-style:italic">//æ— éœ€æˆæƒçš„api
</span><span style="font-style:italic"></span>    Route::get(<span style="font-style:italic">&#39;login&#39;</span>, <span style="font-style:italic">&#39;UserController@login&#39;</span>);

    <span style="font-style:italic">//éœ€è¦æˆæƒçš„api
</span><span style="font-style:italic"></span>    Route::middleware(<span style="font-style:italic">&#39;auth:api&#39;</span>)-&gt;group(<span style="font-weight:bold">function</span> (){
        Route::get(<span style="font-style:italic">&#39;/user&#39;</span>,<span style="font-weight:bold">function</span>(Request $request){
            <span style="font-weight:bold">return</span> auth()-&gt;user();
        });
    });
});



</code></pre></div><p><code>\routes\other.php</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php">&lt;?php

<span style="font-weight:bold">use</span> Illuminate\Http\Request;

<span style="font-style:italic">/*
</span><span style="font-style:italic">|--------------------------------------------------------------------------
</span><span style="font-style:italic">| Other Routes
</span><span style="font-style:italic">|--------------------------------------------------------------------------
</span><span style="font-style:italic">|
</span><span style="font-style:italic">| Here is where you can register Other routes for your application. These
</span><span style="font-style:italic">| routes are loaded by the RouteServiceProvider within a group which
</span><span style="font-style:italic">| is assigned the &#34;other&#34; middleware group. Enjoy building your Other!
</span><span style="font-style:italic">|
</span><span style="font-style:italic">*/</span>
Route::prefix(<span style="font-style:italic">&#39;v1&#39;</span>)-&gt;group(<span style="font-weight:bold">function</span> (){
    Route::get(<span style="font-style:italic">&#39;/login&#39;</span>,<span style="font-style:italic">&#39;OtherController@login&#39;</span>);
    <span style="font-style:italic">//éœ€è¦æˆæƒçš„ other
</span><span style="font-style:italic"></span>    Route::middleware(<span style="font-style:italic">&#39;auth:other&#39;</span>)-&gt;group(<span style="font-weight:bold">function</span> (){
        Route::get(<span style="font-style:italic">&#39;/other&#39;</span>,<span style="font-weight:bold">function</span>(Request $request){
            <span style="font-weight:bold">return</span> auth()-&gt;user();
        });
    });

});



</code></pre></div><h3 id="user-ç”¨æˆ·å‘æ”¾-token">
  User ç”¨æˆ·å‘æ”¾ Token
  <a class="heading-link" href="#user-%e7%94%a8%e6%88%b7%e5%8f%91%e6%94%be-token">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php">&lt;?php

<span style="font-weight:bold">namespace</span> App\Http\Controllers;
<span style="font-weight:bold">use</span> App\User;


<span style="font-weight:bold">class</span> <span style="font-weight:bold">UserController</span> <span style="font-weight:bold">extends</span> Controller
{



    <span style="font-weight:bold">public</span> <span style="font-weight:bold">function</span> login(LoginPost $request)
    {
      $user = User::find(1);
       <span style="font-weight:bold">return</span> $user-&gt;createToken(<span style="font-style:italic">&#39;Api&#39;</span>,[<span style="font-style:italic">&#39;*&#39;</span>])-&gt;accessToken;
    }

}

</code></pre></div><h3 id="other-ç”¨æˆ·å‘æ”¾-token">
  Other ç”¨æˆ·å‘æ”¾ Token
  <a class="heading-link" href="#other-%e7%94%a8%e6%88%b7%e5%8f%91%e6%94%be-token">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php">&lt;?php

<span style="font-weight:bold">namespace</span> App\Http\Controllers;
<span style="font-weight:bold">use</span> App\Other;


<span style="font-weight:bold">class</span> <span style="font-weight:bold">UserController</span> <span style="font-weight:bold">extends</span> Controller
{



    <span style="font-weight:bold">public</span> <span style="font-weight:bold">function</span> login(LoginPost $request)
    {
      $other = Other::find(1);
       <span style="font-weight:bold">return</span> $other-&gt;createToken(<span style="font-style:italic">&#39;Other&#39;</span>,[<span style="font-style:italic">&#39;*&#39;</span>])-&gt;accessToken;
    }

}
</code></pre></div><h3 id="æ ¹æ®-token-è·å–-user-ç”¨æˆ·ä¿¡æ¯">
  æ ¹æ® Token è·å– User ç”¨æˆ·ä¿¡æ¯
  <a class="heading-link" href="#%e6%a0%b9%e6%8d%ae-token-%e8%8e%b7%e5%8f%96-user-%e7%94%a8%e6%88%b7%e4%bf%a1%e6%81%af">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h3>
<p>è·¯ç”±ä¸­å·²å†™æ˜ è¯·æ±‚æ—¶æ³¨æ„ Headers æºå¸¦ Authorization = Bearer $token</p>
<h2 id="æµ‹è¯•">
  æµ‹è¯•
  <a class="heading-link" href="#%e6%b5%8b%e8%af%95">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h2>
<h3 id="get-apiv1login">
  Get api/v1/login
  <a class="heading-link" href="#get-apiv1login">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript">{
    <span style="font-style:italic">&#34;success&#34;</span>: <span style="font-weight:bold">true</span>,
    <span style="font-style:italic">&#34;error_code&#34;</span>: 0,
    <span style="font-style:italic">&#34;message&#34;</span>: <span style="font-style:italic">&#34;è¯·æ±‚æˆåŠŸ&#34;</span>,
    <span style="font-style:italic">&#34;data&#34;</span>: {
        <span style="font-style:italic">&#34;token_type&#34;</span>: <span style="font-style:italic">&#34;Bearer&#34;</span>,
        <span style="font-style:italic">&#34;access_token&#34;</span>: <span style="font-style:italic">&#34;eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJhdWQiOiIxIiwianRpIjoiZGQ2ZmMzNjYwNmU4YjNhNWU1YWQxODMyNDRlNWNlM2JiY2FkNTFkNjc2MGJkZjUxOWMwNzFkNzdiZDY5YjAzZmNlNjc1ZTM0NmQ1MWNkNDUiLCJpYXQiOjE1ODUzMzQwNzgsIm5iZiI6MTU4NTMzNDA3OCwiZXhwIjoxNTg2NTQzNjc3LCJzdWIiOiIyIiwic2NvcGVzIjpbIioiXX0.sQKSS9WCdhMp8_5GTSkQ_sqGMiTVxdVXomub3i3DI3h1xCoAPWYH_rj8W8uTjlX82wzIsFjn0bSKhqTeZFRQDFZWYN-2MatgBk-i6P0dxm-x97sIPfCRMm-omkXIvdWjeJyt...&#34;</span>
    }
}
</code></pre></div><h3 id="get-otherv1login">
  Get other/v1/login
  <a class="heading-link" href="#get-otherv1login">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-JavaScript" data-lang="JavaScript">{
    <span style="font-style:italic">&#34;success&#34;</span>: <span style="font-weight:bold">true</span>,
    <span style="font-style:italic">&#34;error_code&#34;</span>: 0,
    <span style="font-style:italic">&#34;message&#34;</span>: <span style="font-style:italic">&#34;è¯·æ±‚æˆåŠŸ&#34;</span>,
    <span style="font-style:italic">&#34;data&#34;</span>: {
        <span style="font-style:italic">&#34;token_type&#34;</span>: <span style="font-style:italic">&#34;Bearer&#34;</span>,
        <span style="font-style:italic">&#34;access_token&#34;</span>: <span style="font-style:italic">&#34;eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJhdWQiOiIyIiwianRpIjoiZmM0NDQzZmQwZmEwYmMzMTNjM2JlMmE5NjUyNzBiYjc5Y2IwMDBmODM0YzkwNzg1M2U1Y2E1NWY5ZDJjODNhOTM5Y2M0YTU1Mjg4MTJlNTQiLCJpYXQiOjE1ODUzMzQxNDUsIm5iZiI6MTU4NTMzNDE0NSwiZXhwIjoxNTg2NTQzNzQ1LCJzdWIiOiIxIiwic2NvcGVzIjpbXX0.LCXpbAQnFTatXyDJtMZmFitt6mo4_h42CqOd3hbnx...&#34;</span>
    }
}
</code></pre></div><h3 id="get-apiv1user">
  Get api/v1/user
  <a class="heading-link" href="#get-apiv1user">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h3>
<ul>
<li>æºå¸¦ <code>api/v1/login</code> è¿”å›çš„ Token</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript">{
    <span style="font-style:italic">&#34;id&#34;</span>: 2,
    <span style="font-style:italic">&#34;email&#34;</span>: <span style="font-style:italic">&#34;test@163.com&#34;</span>,
    <span style="font-style:italic">&#34;sms_verified_at&#34;</span>: <span style="font-weight:bold">null</span>,
    <span style="font-style:italic">&#34;created_at&#34;</span>: <span style="font-style:italic">&#34;2020-03-15 23:58:39&#34;</span>,
    <span style="font-style:italic">&#34;updated_at&#34;</span>: <span style="font-style:italic">&#34;2020-03-15 23:58:39&#34;</span>,
    <span style="font-style:italic">&#34;check_company_status&#34;</span>: 2
}
</code></pre></div><ul>
<li>æºå¸¦ <code>other/v1/login</code> è¿”å›çš„ Token</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript">{
    <span style="font-style:italic">&#34;success&#34;</span>: <span style="font-weight:bold">false</span>,
    <span style="font-style:italic">&#34;error_code&#34;</span>: 40100,
    <span style="font-style:italic">&#34;message&#34;</span>: <span style="font-style:italic">&#34;æˆæƒå¤±è´¥&#34;</span>,
    <span style="font-style:italic">&#34;data&#34;</span>: []
}
</code></pre></div><h3 id="get-otherv1other">
  Get other/v1/other
  <a class="heading-link" href="#get-otherv1other">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h3>
<ul>
<li>æºå¸¦ <code>api/v1/login</code> è¿”å›çš„ Token</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript">{
    <span style="font-style:italic">&#34;id&#34;</span>: 1,
    <span style="font-style:italic">&#34;user_id&#34;</span>: 1,
    <span style="font-style:italic">&#34;name&#34;</span>: <span style="font-style:italic">&#34;æµ‹è¯•&#34;</span>,
    <span style="font-style:italic">&#34;phone&#34;</span>: <span style="font-style:italic">&#34;138****0869&#34;</span>,
    <span style="font-style:italic">&#34;created_at&#34;</span>: <span style="font-style:italic">&#34;2020-03-20 00:32:55&#34;</span>,
    <span style="font-style:italic">&#34;updated_at&#34;</span>: <span style="font-style:italic">&#34;2020-03-20 00:32:55&#34;</span>,
    <span style="font-style:italic">&#34;user_name&#34;</span>: <span style="font-style:italic">&#34;adminchaochao@163.com&#34;</span>,
    <span style="font-style:italic">&#34;company_name&#34;</span>: <span style="font-style:italic">&#34;æ²³å—æ¨¡å› ç½‘ç»œç§‘æŠ€æœ‰é™å…¬å¸&#34;</span>
}
</code></pre></div><ul>
<li>æºå¸¦ <code>other/v1/login</code> è¿”å›çš„ Token</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript">{
    <span style="font-style:italic">&#34;success&#34;</span>: <span style="font-weight:bold">false</span>,
    <span style="font-style:italic">&#34;error_code&#34;</span>: 40100,
    <span style="font-style:italic">&#34;message&#34;</span>: <span style="font-style:italic">&#34;æˆæƒå¤±è´¥&#34;</span>,
    <span style="font-style:italic">&#34;data&#34;</span>: []
}
</code></pre></div><h3 id="é—®é¢˜">
  é—®é¢˜
  <a class="heading-link" href="#%e9%97%ae%e9%a2%98">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h3>
<p>ç”±æ­¤å¯è§å¹¶ä¸èƒ½æ»¡è¶³éœ€æ±‚ï¼Œä½¿ç”¨ Api å‘æ”¾çš„ Token å¯ä»¥è·å¾—åˆ°ä¸¤ä¸ªç”¨æˆ·çš„ä¿¡æ¯ï¼Œè€Œ Other å‘æ”¾çš„ Token å…¨æ˜¯æˆæƒå¤±è´¥ï¼ŒBye Bye~!!</p>
<p>å“ˆå“ˆï¼Œå¼€ç©ç¬‘äº†å•¦ï¼Œåœ¨è¿™é‡Œè¦ä¸‡åˆ†æ„Ÿè°¢æˆ‘çš„ä¸€ä¸ªå¤§ç¥æœ‹å‹ï½ä»–å¸®å¿™æ‰¾äº†ä¸€ä¸‹åˆçš„æºç ï¼Œæœ€åè°ƒè¯•äº†ä¸­é—´ä»¶æ²¡æ‰§è¡Œï¼ŒåŸæ¥ä¸­é—´ä»¶æ‰§è¡Œæ˜¯æœ‰é¡ºåºçš„ï¼Œé‚£ä¹ˆæ›´æ”¹ä¸€ä¸‹ä¸­é—´ä»¶æ‰§è¡Œé¡ºåºå³å¯ï¼š</p>
<p><code>\app\Http\Kernel.php</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php">		<span style="font-style:italic">//æ‰¾åˆ°è¿™ä¸ª...
</span><span style="font-style:italic"></span>    <span style="font-weight:bold">protected</span> $middlewarePriority = [
        <span style="font-style:italic">//æŠŠåˆšæ‰å®šä¹‰çš„ä¸¤ä¸ªè®¾ç½® Token æ¨¡å‹çš„ä¸­é—´ä»¶æå‰
</span><span style="font-style:italic"></span>      	<span style="font-style:italic">// 1
</span><span style="font-style:italic"></span>        \App\Http\Middleware\OtherPassport::class,
        <span style="font-style:italic">// 2
</span><span style="font-style:italic"></span>        \App\Http\Middleware\ApiPassport::class,
        \Illuminate\Session\Middleware\StartSession::class,
        \Illuminate\View\Middleware\ShareErrorsFromSession::class,
        \App\Http\Middleware\Authenticate::class,
        \Illuminate\Routing\Middleware\ThrottleRequests::class,
        \Illuminate\Session\Middleware\AuthenticateSession::class,
        \Illuminate\Routing\Middleware\SubstituteBindings::class,
        \Illuminate\Auth\Middleware\Authorize::class,
    ];
</code></pre></div><h2 id="å®Œæˆ">
  å®Œæˆ
  <a class="heading-link" href="#%e5%ae%8c%e6%88%90">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h2>
<h3 id="get-apiv1user-1">
  Get api/v1/user
  <a class="heading-link" href="#get-apiv1user-1">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h3>
<ul>
<li>æºå¸¦  <code>api/v1/login</code>  è¿”å›çš„ Token</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript">{
    <span style="font-style:italic">&#34;id&#34;</span>: 2,
    <span style="font-style:italic">&#34;email&#34;</span>: <span style="font-style:italic">&#34;test@163.com&#34;</span>,
    <span style="font-style:italic">&#34;sms_verified_at&#34;</span>: <span style="font-weight:bold">null</span>,
    <span style="font-style:italic">&#34;created_at&#34;</span>: <span style="font-style:italic">&#34;2020-03-15 23:58:39&#34;</span>,
    <span style="font-style:italic">&#34;updated_at&#34;</span>: <span style="font-style:italic">&#34;2020-03-15 23:58:39&#34;</span>,
    <span style="font-style:italic">&#34;check_company_status&#34;</span>: 2
}
</code></pre></div><ul>
<li>æºå¸¦ <code>other/v1/login</code> è¿”å›çš„ Token</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript">{
    <span style="font-style:italic">&#34;success&#34;</span>: <span style="font-weight:bold">false</span>,
    <span style="font-style:italic">&#34;error_code&#34;</span>: 40100,
    <span style="font-style:italic">&#34;message&#34;</span>: <span style="font-style:italic">&#34;æˆæƒå¤±è´¥&#34;</span>,
    <span style="font-style:italic">&#34;data&#34;</span>: []
}
</code></pre></div><h3 id="get-otherv1other-1">
  Get other/v1/other
  <a class="heading-link" href="#get-otherv1other-1">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h3>
<ul>
<li>æºå¸¦ <code>api/v1/login</code> è¿”å›çš„ Token</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript">{
    <span style="font-style:italic">&#34;success&#34;</span>: <span style="font-weight:bold">false</span>,
    <span style="font-style:italic">&#34;error_code&#34;</span>: 40100,
    <span style="font-style:italic">&#34;message&#34;</span>: <span style="font-style:italic">&#34;æˆæƒå¤±è´¥&#34;</span>,
    <span style="font-style:italic">&#34;data&#34;</span>: []
}
</code></pre></div><ul>
<li>æºå¸¦ <code>other/v1/login</code> è¿”å›çš„ Token</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript">{
    <span style="font-style:italic">&#34;id&#34;</span>: 1,
    <span style="font-style:italic">&#34;user_id&#34;</span>: 1,
    <span style="font-style:italic">&#34;name&#34;</span>: <span style="font-style:italic">&#34;æµ‹è¯•&#34;</span>,
    <span style="font-style:italic">&#34;phone&#34;</span>: <span style="font-style:italic">&#34;138****0869&#34;</span>,
    <span style="font-style:italic">&#34;created_at&#34;</span>: <span style="font-style:italic">&#34;2020-03-20 00:32:55&#34;</span>,
    <span style="font-style:italic">&#34;updated_at&#34;</span>: <span style="font-style:italic">&#34;2020-03-20 00:32:55&#34;</span>,
    <span style="font-style:italic">&#34;user_name&#34;</span>: <span style="font-style:italic">&#34;adminchaochao@163.com&#34;</span>,
    <span style="font-style:italic">&#34;company_name&#34;</span>: <span style="font-style:italic">&#34;æ²³å—æ¨¡å› ç½‘ç»œç§‘æŠ€æœ‰é™å…¬å¸&#34;</span>
}
</code></pre></div><h3 id="ä»¥ä¸Š-done">
  ä»¥ä¸Š Done
  <a class="heading-link" href="#%e4%bb%a5%e4%b8%8a-done">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h3>
<p>è°¢è°¢ï¼Œå¦‚æœæœ‰ä»€ä¹ˆæ›´å¥½çš„æ–¹æ³•è¯·ç•™è¨€å“¦ï½</p>

      </div>


      <footer>
        


        
        
        
      </footer>
    </article>

    
  </section>

      </div>

      <footer class="footer">
  <section class="container">
    Â©
    
      2019 -
    
    2022
     Ethan Kuo 
    Â·
    
    Powered by <a href="https://gohugo.io/">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/">Coder</a>.
    
  </section>
</footer>

    </main>

    
      
      <script src="/js/coder.min.39a51230dce2ac866c049b52573e38bf60666af4bc63c1bdf203b9b2d95b1cd6.js" integrity="sha256-OaUSMNzirIZsBJtSVz44v2BmavS8Y8G98gO5stlbHNY="></script>
    

    

    

    

    

    

    

    

    
  </body>

</html>
